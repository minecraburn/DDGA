clear;close all;clc

syms dddd nnnn GF kce kaatr Kagf kdap1 eps vsap1 kde2f kde2fp ...
    kdprb kdpRBp kdpRBpp kpc1 kpc2 kpc3 kpc4 K1 K2 K3 K4 V1 V2 ...
    V3 V4 K1e2f K2e2f V1e2f V2e2f vse2f vsprb Cdk4tot Ki7 Ki8 ...
    kcd1 kcd2 kdecom1 kcom1 kc1 kc2 kddd Kdd K1d K2d Vdd Vm1d ...
    Vm2d ae Cdk2tot ib1 Ki9 Ki10 kc3 kc4 kdecom2 kcom2 kdde ...
    kddskp2 kdpe kdpei Kde Kdceskp2 Kdskp2 Kcdh1 K1e K2e K5e ...
    K6e Vde Vdskp2 Vm1e Vm2e Vm5e V6e vspei vsskp2 xe1 xe2 ...
    aax ib2 Ki11 Ki12 Ki13 Ki14 kca kdecom3 kcom3 kc5 kc6 ...
    kdda kddp27 kddp27p kdcdh1a kdcdh1i kdpa kdpai Kda Kdp27p ...
    Kdp27skp2 Kacdc20 K1a K2a K1cdh1 K2cdh1 K5a K6a K1p27 ...
    K2p27 Vdp27p Vda Vm1a Vm2a Vm5a V6a vscdh1a vspai vs1p27 ...
    vs2p27 V1cdh1 V2cdh1 V1p27 V2p27 xa1 xa2 ab Cdk1tot ib ...
    ib3 kc7 kc8 kdecom4 kcom4 kdcdc20a kdcdc20i kddb kdpb kdpbi ...
    kdwee1 kdwee1p Kdb Kdbcdc20 Kdbcdh1 ksw K1b K2b K3b K4b K5b ...
    K6b K7b K8b vcb Vdb Vm1b Vm2b vscdc20i Vm3b Vm4b Vm5b V6b ...
    Vm7b Vm8b vspbi vswee1 xb1 xb2 ATRtot Chk1tot Cdc45tot kdatr ...
    kdpol kdprim kspol ksprim K1cdc45 K2cdc45 K1chk K2chk Poltot ...
    V1cdc45 V2cdc45 V1chk V2chk Kdw Kiw nc vdw vsw AP1 pRB pRBc1 ...
    pRBp pRBc2 pRBpp E2F E2Fp Cd Mdi Md Mdp27 Ce Mei Me Skp2 ...
    Mep27 Pei Pe Ca Mai Ma Map27 p27 p27p Cdh1i Cdh1a Pai Pa Cb ...
    Mbi Mb Mbp27 Cdc20i Cdc20a Pbi Pb Wee1 Wee1p Cdc45 Pol ...
    Primer ATR Chk1 Mw

Jac_45_dim = jacobian([(vsap1* (GF/(Kagf + GF)) - kdap1 *AP1) * eps;
(vsprb - kpc1 * pRB* E2F + kpc2 * pRBc1 - V1 * (pRB/( K1 + pRB)) * (Md + Mdp27) + V2*(pRBp/( K2 + pRBp)) -    kdprb * pRB) * eps;
(kpc1*pRB*E2F - kpc2*pRBc1)*eps;
(V1 *(pRB/(K1 + pRB)) * (Md + Mdp27) - V2 * (pRBp/(K2 + pRBp)) - V3 * (pRBp/( K3 + pRBp)) * Me + V4 * (pRBpp/( K4 + pRBpp)) - kpc3 * pRBp* E2F + kpc4 * pRBc2 - kdpRBp * pRBp) * eps;
(kpc3 * pRBp* E2F - kpc4 * pRBc2) * eps;
(V3 * (pRBp/(K3 + pRBp)) * Me - V4 * (pRBpp/(K4 + pRBpp)) - kdpRBpp * pRBpp)*eps;
(vse2f - kpc1 * pRB* E2F + kpc2 * pRBc1 - kpc3 * pRBp* E2F +    kpc4 * pRBc2     - V1e2f * Ma* (E2F/( K1e2f + E2F)) +    V2e2f * (E2Fp/( K2e2f + E2Fp)) - kde2f * E2F) * eps;
(V1e2f * Ma* (E2F/(K1e2f + E2F)) -     V2e2f * (E2Fp/( K2e2f + E2Fp)) - kde2fp * E2Fp) * eps;
(kcd1 * AP1 +    kcd2 * E2F * (Ki7/(Ki7 + pRB)) * (Ki8/( Ki8 + pRBp)) -  kcom1 * Cd * (Cdk4tot - (Mdi + Md + Mdp27)) + kdecom1 * Mdi - Vdd * (Cd/( Kdd + Cd)) - kddd * Cd) * eps;
(kcom1 * Cd * (Cdk4tot - (Mdi + Md + Mdp27)) - kdecom1 * Mdi + Vm2d * (Md/( K2d + Md)) -  Vm1d * (Mdi/(K1d + Mdi))) * eps;
(Vm1d * (Mdi/(K1d + Mdi)) - Vm2d * (Md/( K2d + Md)) -  kc1 * Md* p27 + kc2 * Mdp27) * eps;
(kc1 * Md* p27 - kc2 * Mdp27) * eps;
(kce * E2F * (Ki9 /(Ki9 + pRB)) * (Ki10/(Ki10 + pRBp))     - kcom2 * Ce * (Cdk2tot - (Mei + Me + Mep27 + Mai + Ma + Map27))     + kdecom2 * Mei -      Vde * (Skp2/(Kdceskp2 + Skp2)) * (Ce/( Kde + Ce)) - kdde * Ce) *  eps;
(kcom2 *       Ce * (Cdk2tot - (Mei + Me + Mep27 + Mai + Ma + Map27)) -      kdecom2 * Mei + Vm2e * (Wee1 + ib1) * (Me/(K2e + Me)) -      Vm1e * Pe * (Mei/(K1e + Mei))) * eps;
(Vm1e * Pe * (Mei/( K1e + Mei)) -      Vm2e * (Wee1 + ib1) * (Me/( K2e + Me)) - kc3 * Me* p27 +      kc4 * Mep27) * eps;
(vsskp2 -      Vdskp2 * (Skp2/(Kdskp2 + Skp2)) * (Cdh1a/(Kcdh1 + Cdh1a)) -      kddskp2 * Skp2) * eps;
(kc3 * Me* p27 - kc4 * Mep27) * eps;
(vspei + V6e * (xe1 + xe2 * Chk1) * (Pe/(K6e + Pe))     - Vm5e * (Me + ae) * (Pei/(K5e + Pei)) - kdpei * Pei) * eps;
(Vm5e * (Me + ae) * (Pei/(K5e + Pei))     - V6e * (xe1 + xe2 * Chk1) * (Pe/( K6e + Pe)) - kdpe * Pe) * eps;
(kca * E2F * (Ki11/( Ki11 + pRB)) * (Ki12/(Ki12 + pRBp))     - kcom3 * Ca* (Cdk2tot - (Mei + Me + Mep27 + Mai + Ma + Map27))     + kdecom3 * Mai -  Vda * (Ca/(Kda + Ca)) * (Cdc20a/( Kacdc20 + Cdc20a)) -      kdda * Ca) * eps;
(kcom3 *       Ca* (Cdk2tot - (Mei + Me + Mep27 + Mai + Ma + Map27)) -      kdecom3 * Mai + Vm2a * (Wee1 + ib2) * (Ma/(K2a + Ma)) -      Vm1a * Pa* (Mai/(K1a + Mai))) * eps;
(Vm1a * Pa* (Mai/( K1a + Mai)) -      Vm2a * (Wee1 + ib2) * (Ma/( K2a + Ma)) - kc5 * Ma* p27 +      kc6 * Map27) * eps;
(kc5 * Ma* p27 - kc6 * Map27) * eps;
(vs1p27 +      vs2p27 * E2F * (Ki13/( Ki13 + pRB)) * (Ki14/(Ki14 + pRBp)) -      kc1 * Md * p27 + kc2 * Mdp27 - kc3 * Me* p27 + kc4 * Mep27 -      kc5 * Ma* p27 + kc6 * Map27 - kc7 * Mb* p27 + kc8 * Mbp27 -    V1p27 * Me* (p27/(K1p27 + p27)) +      V2p27 * (p27p/( K2p27 + p27p)) - kddp27 * p27) * eps;
(V1p27 * Me* (p27/(K1p27 + p27)) -      V2p27 * (p27p/(K2p27 + p27p))     - Vdp27p * (Skp2/( Kdp27skp2 + Skp2)) * (p27p/(Kdp27p + p27p)) -      kddp27p * p27p) * eps;
(V2cdh1 * (Cdh1a/( K2cdh1 + Cdh1a)) * (Ma + Mb) -      V1cdh1 * (Cdh1i/( K1cdh1 + Cdh1i)) - kdcdh1i * Cdh1i) * eps;
(vscdh1a + V1cdh1 * (Cdh1i/(K1cdh1 + Cdh1i)) -      V2cdh1 * (Cdh1a/( K2cdh1 + Cdh1a)) * (Ma + Mb)     - kdcdh1a * Cdh1a) * eps;
(vspai +     V6a * (xa1 + xa2 * Chk1) * (Pa /(K6a + Pa)) -     Vm5a * (Ma + aax ) * (Pai/( K5a + Pai)) - kdpai * Pai) *   eps; %*Subscript[a, a)\[Rule)aax**)
(Vm5a * (Ma + aax) * (Pai/( K5a + Pai)) -     V6a * (xa1 + xa2 * Chk1) * (Pa/(K6a + Pa)) - kdpa * Pa) * eps;
(vcb - kcom4 * Cb* (Cdk1tot - (Mbi + Mb + Mbp27)) +      kdecom4 * Mbi     - Vdb * (Cb/( Kdb + Cb)) *((Cdc20a/(  Kdbcdc20 + Cdc20a)) + (Cdh1a/(Kdbcdh1 + Cdh1a))) -    kddb * Cb) * eps;
(kcom4 * Cb* (Cdk1tot - (Mbi + Mb + Mbp27)) - kdecom4 * Mbi +      Vm2b * (Wee1 + ib3 ) * (Mb/( K2b + Mb)) -      Vm1b * Pb* (Mbi/( K1b + Mbi))) * eps;
(Vm1b * Pb* (Mbi/(K1b + Mbi)) -      Vm2b * (Wee1 + ib3) * (Mb/(K2b + Mb)) - kc7 * Mb* p27 +      kc8 * Mbp27) * eps;
(kc7 * Mb* p27 - kc8 * Mbp27) * eps;
(vscdc20i - Vm3b * Mb* (Cdc20i/( K3b + Cdc20i)) +      Vm4b * (Cdc20a/( K4b + Cdc20a))     - kdcdc20i * Cdc20i) * eps;
(Vm3b * Mb* (Cdc20i/(K3b + Cdc20i)) -      Vm4b * (Cdc20a/( K4b + Cdc20a))     - kdcdc20a * Cdc20a) * eps;
(vspbi + V6b * (xb1 + xb2 * Chk1) * (Pb/(K6b + Pb))     - Vm5b * (Mb + ab) * (Pbi/(K5b + Pbi)) - kdpbi * Pbi) * eps;
(Vm5b * (Mb + ab) * (Pbi/(K5b + Pbi))     - V6b * (xb1 + xb2 * Chk1) * (Pb/( K6b + Pb)) - kdpb * Pb) * eps;
(vswee1 + ksw * Mw - Vm7b * (Mb + ib) * (Wee1/(K7b + Wee1)) +      Vm8b * (Wee1p/( K8b + Wee1p)) - kdwee1 *Wee1) * eps;
(Vm7b * (Mb + ib ) * (Wee1/( K7b + Wee1)) -    Vm8b * (Wee1p/(K8b + Wee1p))     - kdwee1p *Wee1p) * eps;
(V1cdc45 *  Me * ((Cdc45tot - Cdc45)/( K1cdc45 + (Cdc45tot - Cdc45))) -    V2cdc45 * (Cdc45/(K2cdc45 + Cdc45)) -  kspol * (Poltot - Pol) * Cdc45 + kdpol * Pol) * eps;
(kspol * (Poltot - Pol) * Cdc45 - kdpol * Pol) * eps;
(ksprim * Pol - kdprim * Primer -      kaatr * (ATRtot - ATR) * Primer + kdatr * ATR) * eps;
(kaatr * (ATRtot - ATR) * Primer - kdatr * ATR) * eps;
(V1chk * ATR* ((Chk1tot - Chk1)/(K1chk + (Chk1tot - Chk1))) -      V2chk * (Chk1/( K2chk + Chk1))) * eps; ...
0],...
 [AP1 pRB pRBc1 pRBp pRBc2 pRBpp E2F E2Fp Cd Mdi Md Mdp27 Ce Mei Me Skp2 Mep27 Pei Pe...
Ca Mai Ma Map27 p27 p27p Cdh1i Cdh1a Pai Pa Cb Mbi Mb Mbp27 Cdc20i Cdc20a Pbi Pb Wee1 Wee1p Cdc45 Pol Primer ATR Chk1 Mw]);

% save Jac_45_dim.mat Jac_45_dim
